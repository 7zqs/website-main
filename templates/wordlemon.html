<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='wordlemon.css') }}">
    <title>Wordlemon</title>
</head>

<body>

<div class="header">
    <h1 class="title">Wordlemon</h1>
</div>

<div class="main">

<nav class="main-tab">

<ul class="link-list">
    <li class="information">
        <p class="listheader">Information</p>
        <ul class="info-links">
            <li id="mainpage">
                <a href="{{ url_for('home', _external=True) }}">Main Page</a>
            </li>
        </ul>
    </li>
    <li class="game-list">
        <p class="listheader">Games</p>
        <ul class="game-links">
            <li id="wordlemon-link">
            Wordlemon
            </li>
            <li id="word-guess">
            <a href="file:///home/kiri/Documents/web/pkmn/templates/test.html">Guess the Word</a>
            </li>
        </ul>
    </li>
</ul>

</nav>

<div class="main-box">
    <h1 class="box-title">Information</h1>
<p class="wordlemon-info">
    This game is about guessing Pok√©mon based on their given attributes.<br>
    Start the game by guessing a Pok√©mon's Name, and see how close their attributes are to the correct Pok√©mon.<br>
    This game includes gen 1-5 Pok√©mon, no pokemon above gen 5 are included.<br>
    üü• -> Entirely wrong. <br>
    üüß -> within 100. (For BST only.) <br>
    üü® -> Partially correct. (within 50 for BST) <br>
    üü© -> Correct. <br>
</p>
<div class="counter">
    Guess {{ guess_count }} / {{ max_guesses }}
</div>

<form method="POST" action="{{ url_for('wordlemon', _external=False) }}">
    <input
        type="text"
        name="guess"
        id="guess-input"
        list="pokemon-list"
        autocomplete="on"
        required
    >
    <datalist id="pokemon-list">
        {% for name in all_pokemon_names %}
            <option value="{{ name }}">
        {% endfor %}
    </datalist>
    <button type="submit">Guess</button>
</form>

{% if message %}
<p class="message">{{ message }}</p>
{% endif %}

{% if finished_card %}
<div class="guess-container-grid">
    {% set name, result, types = finished_card %}
    <div class="pokemon-card winner-card"
         style="--type1: {{ type_colors[types[0]|lower] }};
                --type2: {% if types|length > 1 %}{{ type_colors[types[1]|lower] }}{% else %}transparent{% endif %};">
        <div class="card-header">
            <div class="header-bg">
                <h2>{{ name.capitalize() }}</h2>
            </div>
        </div>
        <img class="sprite"
             src="{{ url_for('static', filename='gifs/' + name|lower + '.gif') }}">
        

        <div class="card-body">
            {% for attr in attribute_order %}
                <div class="stat-row {{ result[attr][0] }}">
                    <span class="stat-name">{{ attr }}</span>
                    <span class="stat-value">{{ result[attr][1] }}</span>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}


<div class="guess-container-grid">
    {% for name, result, types in guesses %}
        {% if types|length == 2 %}
        <div class="pokemon-card"
            style="--type1: {{ type_colors[types[0]|lower] }};
                    --type2: {{ type_colors[types[1]|lower] }};">
        {% else %}
        <div class="pokemon-card"
            style="--type1: {{ type_colors[types[0]|lower] }};
                    --type2: transparent;">
        {% endif %}
            <div class="card-header">
                     <div class="header-bg">
                        <h2>{{ name.capitalize() }}</h2>
                     </div>
            </div>
            <img class="sprite" src="{{ url_for('static', filename='gifs/' + name|lower + '.gif') }}">
            <div class="card-body">
                {% for attr in attribute_order %}
                    <div class="stat-row {{ result[attr][0] }}">
                        <span class="stat-name">{{ attr }}</span>
                        <span class="stat-value">{{ result[attr][1] }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>

</div>

</div>

</body>

{% include "footer.html" %}

</html>

<script>
const input = document.getElementById("guess-input");
const names = {{ all_pokemon_names | tojson | safe }};
input.addEventListener("input", function() {
    const val = this.value.toLowerCase();
    const suggestions = names.filter(n => n.toLowerCase().startsWith(val)).slice(0, 10);
    // This is just a simple suggestion console.log
    console.log(suggestions);
});
</script>